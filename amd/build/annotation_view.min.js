define([],function(){return{init:function(){function d(){this.init=function(e){this.el=e;var t=this,n=JSON.parse(e.dataset.setup||"{}"),i=(this.svg=e.querySelector("svg"),this.svg&&(this.svg.style.display="none"),e.querySelector("video")),e=e.querySelector("img");e?((this.container=e).addEventListener("load",function(){t.resize()}),e.addEventListener("error",function(){t.resize()}),e.complete&&requestAnimationFrame(function(){t.resize()})):(this.container=i)&&i.addEventListener("loadedmetadata",function(){i.currentTime=n.comment_timestamp,t.resize()},!1)},this.resize=function(){this.svg&&this.container&&(this.svg.style.width=this.container.offsetWidth+"px",this.svg.style.height=this.container.offsetHeight+"px",this.svg.style.display="block")}}function e(){document.querySelectorAll(".field-ivs-annotation-preview").forEach(function(e){(new d).init(e)})}function t(){document.querySelectorAll("div.annotation-view-comment-container").forEach(function(s){new window.IntersectionObserver(([e])=>{var t,n,i,o=s.querySelector(".video_placeholder"),r=s.querySelector("video");e.isIntersecting&&o?(console.log("enter",s),n=document.createElement("video"),i=document.createElement("source"),t=document.createElement("div"),n.id=o.dataset.videotagid,i.src=o.dataset.videosrc,i.type="video/mp4",t.innerText="Sorry, your browser or device is not supported!",n.appendChild(i),n.appendChild(t),o.parentNode.replaceChild(n,o),(i=s.querySelector(".field-ivs-annotation-preview"))&&(new d).init(i)):!e.isIntersecting&&r&&(console.log("leave",s),t=document.createElement("div"),(n=document.createElement("div")).classList.add("lds-dual-ring"),t.appendChild(n),t.classList.add("video_placeholder"),t.dataset.videotagid=r.id,(o=r.querySelector("source"))&&(t.dataset.videosrc=o.src),(i=r.nextElementSibling)&&"svg"===i.tagName&&(i.style.display="none"),r.parentNode.replaceChild(t,r))},{root:null,threshold:0}).observe(s)})}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",function(){e(),t()}):(e(),t())}}});
//# sourceMappingURL=annotation_view.min.js.map